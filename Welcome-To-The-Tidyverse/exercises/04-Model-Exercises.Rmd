---
title: "Modelos"
---

```{r setup}
library(tidyverse)
library(modelr)
library(broom)

# Import wages here

# Fall back in case you cannot load wages
 wages <- heights %>%
   filter(income > 0) %>%
   mutate(marital = as.character(marital),
          sex = as.character(sex))
```

## Tu turno 1

* Cambiá el directorio de trabajo a `04-Models`. 
* Importá `wages.xlsx` como wages y *copia el código de importación a tu chunk de setup*.
* Asegurate de setear NA: to NA.

```{r}
setwd("~/Workspace/codium/tidyverse/remaster-the-tidyverse/Welcome-To-The-Tidyverse")
library(readxl)
#wages <- read_excel("wages.xlsx", na = NA)
View(wages)
```


## Tu turno 2

Ajustá el modelo de la diapositiva y examiná la salida. ¿A qué se parece?

```{r}
mod_e <- lm(log(income) ~ education, data = wages)
mod_e
```

## Tu turno 3

Modelá `log(income)` como función de `height`. Luego usá funciones de broom y dplyr para extraer:

1. Los **coeficientes estimados** y sus estadísticas
2. El **adj.r.squared** y **p.value** del modelo

```{r}

```


## Tu turno 4

Modelá `log(income)` en función de `education` y `height` y `sex`. ¿Podés interpretar los coeficientes?

```{r}
mod_ehs <- wages %>% 
  lm(log(income) ~ education + height + sex, data = .)

mod_ehs %>% 
  tidy()
```

## Tu turno 5

Añadí `+ geom_smooth(method = lm)` al código de abajo. ¿Qué pasa?

```{r}
wages %>%
     ggplot(aes(x = height, y = log(income))) +
     geom_point(alpha = 0.1)
```

## Ayuda

```{r}

```


## Tu turno 6

Usá `gather_residuals` para completar el código de abajo, que compara los residuales de los tres modelos, `mod_h`, `mod_eh`, y `mod_ehs`.

```{r warning = FALSE, message = FALSE}

# En caso de no haber implementado los 3 modelos
mod_h <- wages %>% lm(log(income) ~ height, data = .)
mod_eh <- wages %>% lm(log(income) ~ education + height, data = .)
mod_ehs <- wages %>% lm(log(income) ~ education + height + sex, data = .)

# Asegurate de borrar los _ antes de ejecutar el código
wages %>% 
  _____________(______, ______, ______) %>% 
  ggplot() ___ 
    geom_histogram(aes(x = ______)) +
    facet_grid(_____ ~ .)
```

***

# Resumen

* Usá `glance()`, `tidy()`, y `augment()` del paquete **broom** para retornar los valores de tus modelos en un data frame.

* Usá `add_predictions()` o `gather_predictions()` o `spread_predictions()` del paquete **modelr** para visualizar predicciones.

* Usá `add_residuals()` o `gather_residuals()` o `spread_residuals()` del paquete **modelr** para visualizar residuales.
